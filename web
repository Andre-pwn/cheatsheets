FROM PORTSWIGGER ACADEMY - BURPSUITE CERTIFIED PREPARATION

SSTI
prova bypass filtro char alfanumerico con %0A

'"

SQL INJECTION

' or 1=1--

detection: 
  '
  or 1=1 or 1=2 per triggherare errori maybe
  sql specific syntax
  payloads with delay
  OAST payloads per triggerare out of band network interactions  https://portswigger.net/blog/oast-out-of-band-application-security-testing

WHERE e SELECT sono i punti vulnerabili più frequenti. altri possono essere:

UPDATE -> sui valori da aggiornare
INSERT -> sui valori da inserire
SELECT -> sul nome colonna
SELECT -> su order by

-- per commentare il seguito e non eseguirlo
es. https://insecure-website.com/products?category=Gifts'--

SUBVERTING APP LOGIC
se per loggare mi chede username e password, io commento dopo l'username così non chiede la password nella query
es. administrator'--
SELECT * FROM users WHERE username = 'administrator'--' AND password = ''

prendere dati da altre tabelle con UNION

blind SQL injection
non ritorna errori o risultati evidenti
di solito si cerca di sovvertire la logica applicativa per restituire risultati diversi da quelli aspettati, o tramite boolean conditions, triggerare delay con le funzioni di timer oppure OAST per generare traffico sulla rete detectabile

SECOND ORDER SQL INJECTION

input viene salvato nel database e magari viene richiamato in altre funzioni ma non immediatamente, esempio stored xss
azione che viene eseguita con il payload caricato in precedenza tramite sqli

examining database version and stuff via specific commands and errors - consult cheatsheets such as https://portswigger.net/web-security/sql-injection/cheat-sheet and others

encode the payload in the way the requests are made, considering xml and json inputs

PREVENZIONE SQL INJECTION
query parametrizzate
esempio:

PreparedStatement statement = connection.prepareStatement("SELECT * FROM products WHERE category = ?");
statement.setString(1, input);
ResultSet resultSet = statement.executeQuery();
